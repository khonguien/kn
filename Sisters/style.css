/* --- CẤU HÌNH CHUNG --- */
:root {
    --envelope-width: 240px;
    --envelope-height: 320px;
    --envelope-color: #d32f2f;
    --flap-color: #bc2626;
    --bg-color: #ffebee;
    --anim-speed: 0.5s;
}

body {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background-color: var(--bg-color);
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    overflow: hidden;
}

/* --- XẾP HÌNH CHỮ V --- */
.envelopes-container {
    position: relative;
    width: 100%;
    max-width: 600px;
    height: 400px;
    display: flex;
    justify-content: center;
    align-items: flex-end;
}

.v-wrapper {
    position: absolute;
    bottom: 0;
    transition: transform 0.6s cubic-bezier(0.34, 1.56, 0.64, 1), filter 0.6s ease, z-index 0s;
    z-index: 10;
}

.left-envelope { transform: translateX(-50%) rotate(-15deg); transform-origin: bottom right; }
.right-envelope { transform: translateX(50%) rotate(15deg); transform-origin: bottom left; }

/* --- TRẠNG THÁI ACTIVE / INACTIVE --- */
.v-wrapper.active {
    transform: translateX(0) scale(1.15) rotate(0deg) translateY(-20px);
    z-index: 50; 
    filter: brightness(1);
}

.v-wrapper.inactive {
    z-index: 5; 
    filter: brightness(0.4); 
}

.left-envelope.inactive { transform: translateX(-70%) scale(0.8) rotate(-25deg) translateY(30px); }
.right-envelope.inactive { transform: translateX(70%) scale(0.8) rotate(25deg) translateY(30px); }

/* --- BAO LÌ XÌ --- */
.envelope-wrapper {
    position: relative;
    width: var(--envelope-width);
    height: var(--envelope-height);
    cursor: pointer;
    animation: float 2.5s ease-in-out infinite;
}

.envelope-wrapper.open { animation: none; }

.envelope-body {
    position: absolute; bottom: 0; width: 100%; height: 100%;
    background-color: var(--envelope-color);
    border-radius: 0 0 10px 10px; z-index: 10;
    box-shadow: 0 10px 20px rgba(0,0,0,0.2);
}

.envelope-flap {
    position: absolute; top: 0; width: 100%; height: 100%;
    background-color: var(--flap-color);
    clip-path: polygon(0 0, 50% 25%, 100% 0);
    transform-origin: top;
    transition: transform 0.4s ease-in-out, z-index 0.4s;
    z-index: 20;
}

.envelope-pocket {
    position: absolute; bottom: 0; width: 100%; height: 100%;
    background-color: #b71c1c; border-radius: 0 0 10px 10px; z-index: 1;
}

.envelope-name {
    position: absolute; top: 60%; left: 50%; transform: translate(-50%, -50%);
    color: #ffd700; font-size: 1.rem; font-weight: bold; text-align: center;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.3); z-index: 25; pointer-events: none;
}

/* --- TỜ THƯ (CARD) --- */
.content-card {
    position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
    width: 90%; height: 95%; background: #fffcf2; color: #b71c1c;
    border: 2px dashed #d4af37; border-radius: 8px;
    display: flex; flex-direction: column; align-items: center; justify-content: flex-start;
    text-align: center; z-index: 5; padding: 30px 15px 15px 15px; box-sizing: border-box;
}

.greeting-title {
    color: #d32f2f; margin: 0 0 15px 0; font-size: 1.1rem;
    border-bottom: 2px solid #d4af37; padding-bottom: 5px;
}

.message { font-size: 0.85rem; color: #333; line-height: 1.6; text-align: justify; }

/* --- ANIMATION KEYFRAMES THƯ --- */
@keyframes slide-out-drop {
    0% { bottom: 0; z-index: 5; }
    50% { bottom: 220px; z-index: 5; }
    51% { z-index: 30; }
    100% { bottom: 80px; z-index: 30; }
}

@keyframes slide-up-in {
    0% { bottom: 80px; z-index: 30; }
    40% { bottom: 220px; z-index: 30; }
    41% { z-index: 5; }
    100% { bottom: 0; z-index: 5; }
}

@keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

/* --- TRẠNG THÁI MỞ BAO --- */
.envelope-wrapper.open .envelope-flap { transform: rotateX(180deg); z-index: 1; transition-delay: 0s; }
.envelope-wrapper.open .content-card { animation: slide-out-drop 1s forwards; animation-delay: 0.3s; }
.envelope-wrapper.open .envelope-name { opacity: 0; transition: opacity 0.3s; }

/* --- TRẠNG THÁI ĐÓNG BAO --- */
.envelope-wrapper.close-opt .envelope-flap { transition-delay: 0.8s; }
.envelope-wrapper.close-opt .content-card { animation: slide-up-in 1s forwards; }
.envelope-wrapper.close-opt .envelope-name { opacity: 1; transition-delay: 1s; }

/* --- MOBILE RESPONSIVE --- */
@media screen and (max-width: 600px) {
    :root { var(--envelope-width): 170px; var(--envelope-height): 230px; }
    .left-envelope { transform: translateX(-35%) rotate(-15deg); }
    .right-envelope { transform: translateX(35%) rotate(15deg); }
    .v-wrapper.active { transform: translateX(0) scale(1.2) rotate(0deg) translateY(-20px); }
    .left-envelope.inactive { transform: translateX(-50%) scale(0.8) rotate(-25deg) translateY(30px); }
    .right-envelope.inactive { transform: translateX(50%) scale(0.8) rotate(25deg) translateY(30px); }
    .greeting-title { font-size: 1.1rem; }
    .message { font-size: 0.8rem; }
}
